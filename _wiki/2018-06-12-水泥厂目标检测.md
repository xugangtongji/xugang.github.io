---
layout: wiki
title: 水泥厂目标检测
categories: 同济大学项目
comments: false
description: 
keywords: 
mathjax: true
---

### 基于深度学习的卫星地图水泥厂目标检测与定位

环保部卫星环境应用中心合作项目（北京）

项目要求：使用深度学习目标检测算法，对卫星地图上的水泥厂建筑目标进行检测，返回地理坐标。检出率达到80%以上。

![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-11-01-09.jpg)

训练数据集：京津冀地区，制作方法见[链接](https://xugang.ink/2017/12/14/%E6%B0%B4%E6%B3%A5%E5%8E%82%E6%95%B0%E6%8D%AE%E5%88%B6%E4%BD%9C/)

![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-11-00-51.jpg)


### 摘要：
鉴于深度学习在视觉目标检测领域的成功应用，所以本文将研究应用深度卷积神经网络方法，实现在卫星图像上识别与定位水泥厂目标，为环保部门提供一种高效便捷的水泥厂目标检测和统计方法。基于面向目标检测与定位的Faster R-CNN深度学习框架，以准确检测与定位水泥厂区域为目的，以京津冀地区的水泥厂位置作为训练和测试数据集，选用ZF、VGG、ResNet三种提取特征的卷积神经网络进行了对比实验。并针对小样本训练容易出现的过拟合和误检问题，采用了图像去雾预处理、数据扩充、引入负样本等技术进一步提升模型能力。结果 测试集实验结果表明ResNet特征提取网络效果最好，准确率达到了74%。为了进一步提高检出率并降低误检率，引入三种模型能力提升的方法，在扩充检测数据集中的检出率达到了94%，误检率降低到14%；在全球水泥厂数据集中的图片检出率达到了96%，万张随机图像的误检数量为30张（0.3%）。对上海地区的卫星图像进行扫描检测，结果检测出11个已登记的水泥厂（共登记16个），另外还检测出17个未登记的水泥厂。结论 对于卫星地图上水泥厂这种具有特殊建筑构造但也存在厂区几何形状各异、所处地理环境复杂、随季节性变化等特点，本文提出的基于深度卷积网络的卫星图像水泥厂检测方法，能够自动学习提取有效的图像特征并对目标进行准确检测。针对小样本训练的问题，引入了三种方法显著提高了模型的检测精度。在模型泛化能力测试中，经过优化后的模型在水泥厂建筑目标检测任务中表现良好，具有重要的应用价值。

### 正文：

目前还没有公开发表的关于使用卫星图像对水泥厂这种建筑目标进行检测与定位的研究。卫星图像目标检测需要实现定位和分类两种任务，传统定位方法一般需要进行窗口扫描或者提取前景目标框，再进行图像分类的处理速度极慢而且目标检测框也不准确。人工设计特征的方法对水泥厂这种特殊建筑目标是不合适的，因为在生产规模、设备构成、厂区结构、坐落方位等方面差异很大，导致卫星图像中的水泥厂呈现多种多样的表观。如图1列举几个的水泥厂卫星图像可以看出，厂区之间差异巨大，除此之外复杂多变的自然地理形貌和人工建筑的干扰，使得传统图像特征处理方法难以胜任卫星图像水泥厂目标检测与识别任务。


![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-10-59-43.png)


图1形态各异的水泥厂卫星图像

自2012年Krizhevsky等人[5]设计的AlexNet卷积神经网络在ImageNet图像识别挑战比赛中获得第一名后，卷积神经网络（CNN，Convolutional Neural Networks）成为人工智能和计算机视觉领域的研究热点。这是一种能够自动学习卷积核参数来提取图像特征的监督式学习方法。

近几年，有学者开始将卷积神经网络技术应用在遥感卫星图像的目标检测识别。2017年周明非等人[6]用卷积神经网络的三种模型（AlexNet、CaffeNet、VGG）在UC Merced Land Use高分辨率卫星图像数据集上对机场、停车场、立交桥等21类进行目标分类。其中VGG-19模型的分类准确度达96%，验证了深层卷积模型具有强大的特征提取和分类能力。Maggiori等人[7]提出了一种针对卫星图像上密集目标的全卷积神经网络检测框架，实现了对卫星图像上人工建筑目标区域的分割和像素级别的定位，但这种方法只能区别人工建筑类型与非建筑类型，在水泥厂目标检测中，需要识别属于水泥厂建筑和非水泥厂建筑。Chen等人[8]设计了一种3D卷积结构网络，用来提取高光谱图像的空间和光谱特征，从而进行分类，在三个高光谱数据集中检测精度达到了先进水平。高光谱图像数据量庞大，存在冗余，获取成本较高，而卫星上普通光学相机拍摄的RGB图像具有信息丰富、符合人眼观察规律、获取成本低、渠道来源广的特点更适合用来作为水泥厂目标检测的卫星图像数据源。

2014年Girshick等人利用深度卷积神经网络设计了基于预选区域的R-CNN方法[9]，在图像目标检测与定位任务中打破了传统的DPM（Deformable Parts Model，可变部件模型）算法[10]在图像目标检测领域的领先地位。后续又提出了Faster R-CNN[11]模型，进一步提升了目标检测速度和识别准确度。该方法在图像目标检测领域有着优异表现，也符合水泥厂目标检测的任务需求。

针对以上研究现状结合水泥厂目标的特点和实际任务需求，本文将探索应用深度学习技术实现在高分辨率卫星地图上实时快速检测水泥厂目标，提取精确的地理位置和粗略估计厂区大小，从而便于环保部门对各地区水泥厂的地理位置、规模和数量进行统计和监控。

#### 基于Faster R-CNN框架的水泥厂图像检测流程
![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-11-00-21.png)

#### 模型训练

![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-11-01-26.png)

#### 卷积可视化
![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-11-01-37.png)

#### 检测结果
![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-11-02-12.jpg)

#### 上海地区扫描结果

![](http://p5iojc2zy.bkt.clouddn.com/_wiki/_image/2018-10-10-11-02-53.png)


### 结论：

本文使用Faster R-CNN深度卷积神经网络框架模型对卫星图像水泥厂目标进行检测，比较测试了VGG16、ZF、ResNet三种特征提取网，使用京津冀地区的水泥厂数据作为训练数据，实现了卫星图像水泥厂目标检测与定位，根据检测框的大小可以粗略估计厂区面积。实验结果表明ResNet网络的表现最好，经过调参训练后的平均准确率为74%。但由于样本数量小且误检率也相对较高，本文进一步采用了图像预处理、数据扩充、加入负样本训练等方法提升了模型的能力。在扩充测试集上达到了94%的检出率，在Global Cement Dataset数据集上达到了96%的检出率，万张随机负样本误检降低至30张。对上海地区整个卫星图像集的扫描检测结果表明，深度卷积目标检测模型不仅能检出大部分已登记的水泥厂，还能检测出未登记的水泥厂，为环境污染源监控提供可靠参考。
通过本文的实验表明，深度学习在卫星图像的目标检测任务表现良好。针对水泥厂这种训练数据样本较少的情况，在未来的研究当中我们将考虑结合水泥厂的内部建筑功能划分加入先验知识，以及结合迁移学习的前沿技术训练通用的卫星图像目标检测模型。另外还将考虑使用图像分割的方案，将水泥厂建筑区域分割出来，这样检测区域更符合现实情况，还可以准确估计厂区大小。

