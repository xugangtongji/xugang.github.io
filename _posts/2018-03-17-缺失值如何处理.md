---
layout: post
title: 缺失值处理方法
categories: 机器学习
comments: false
description: 
keywords: 机器学习
mathjax: true
---
#### 机器学习的缺失值处理：
在介绍缺失数据的解决方案之前，需要明确几个相关的统计概念：
1. 完全随机缺失的: 如果Y缺失数据的概率与**Y本身的值或在该数据组中任何其他变量的值**都无关的。
2. 随机缺失MAR: 控制了其他变量后，Y缺失数据的概率与Y值无关

**解决方法：**

3. **期望最大化（EM）**的算法来处理，期望最大算法是一种从不完全数据或有数据丢失的数据集（存在隐含变量）中求解概率模型参数的最大似然估计方法。很多商业软件已经有计算方法，缺点为：由线性模型化所报告的软件标准误和检验统计量并不正确，且对于过度识别模型，估计值不是全然有效的。
4. **虚拟变量D**。假设某变量X有一些缺失数据，X为回归分析中数个自变量的其中一个，那么可以建立一个虚拟变量D，如果X存在数据缺失则D=1，否则D=0。同时建立一个变量X'，使得当不存在数据缺失时X'=X，否则X'等于一个任意常数c。
5. 不可忽略的缺失数据：**进行敏感性分析**，因为根据假设的模型，结果可能变化很大，故试验一定范围内的模型并看它们是否产生相同的结果是很重要的。

#### 【转自知乎】三类处理方法：

2. 个例删掉；随机森林本身可以处理缺失值。
1. 用平均值、中值、插值、众数、随机值等替代。效果一般，因为等于人为增加了噪声。
2. 用其他变量做预测模型来**算出缺失变量**。效果比方法1略好。有一个根本缺陷，如果其他变量和缺失变量无关，则预测的结果无意义。如果预测结果相当准确，则又说明这个变量是没必要加入建模的。一般情况下，介于两者之间。
3. 最精确的做法，**把变量映射到高维空间**。比如性别，有男、女、缺失三种情况，则映射成3个变量：是否男、是否女、是否缺失。连续型变量也可以这样处理。比如Google、百度的CTR预估模型，预处理时会把所有变量都这样处理，达到几亿维。这样做的好处是**完整保留了原始数据的全部信息**、不用考虑缺失值、不用考虑线性不可分之类的问题。缺点是计算量大大提升。而且只有在**样本量非常大的时候效果才好**，否则会因为过于稀疏，效果很差。

参考文献：<br>
Little R J A, Rubin D B. Statistical analysis with missing data[M]. John Wiley & Sons, 2014.<br>



